{% extends "base.html" %}
{% block title %}Transfer Money{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2 class="mb-4">Transfer Money</h2>

  <!-- 🔁 Transfer Form -->
  <form method="POST" action="{{ url_for('customer.transfer') }}">
    {{ form.hidden_tag() }}

    <div class="form-group">
      <label for="beneficiary_name">Beneficiary Name</label>
      <input type="text" class="form-control" id="beneficiary_name" name="beneficiary_name" required>
    </div>

    <div class="form-group mt-2">
      <label for="account_number">Account Number</label>
      <input type="text" class="form-control" id="account_number" name="account_number" required>
    </div>

    <div class="form-group mt-2">
      <label for="amount">Amount (₹)</label>
      <input type="number" class="form-control" id="amount" name="amount" step="0.01" required>
    </div>

    <div class="form-check mt-3">
      <input type="checkbox" class="form-check-input" id="save_contact" name="save_contact">
      <label class="form-check-label" for="save_contact">Save this contact</label>
    </div>

    <button type="submit" class="btn btn-primary mt-3">Transfer</button>
  </form>

  <!-- 🔁 Recent Recipients Section -->
  {% if saved_contacts %}
  <hr>
  <h4 class="mt-4">Recent Recipients</h4>
  <ul class="list-group">
    {% for contact in saved_contacts %}
    <li class="list-group-item d-flex align-items-center">
      <img src="{{ url_for('static', filename='uploads/default.png') }}" alt="Profile" width="30" class="me-2">
      <button type="button" class="btn btn-link p-0 text-decoration-none" onclick="prefillTransfer('{{ contact.name }}', '{{ contact.account_number }}')">
        {{ contact.name }} ({{ contact.account_number }})
      </button>
    </li>
    {% endfor %}
  </ul>
  {% endif %}
</div>

<!-- 🧠 JS for Prefilling Form -->
<script>
  function prefillTransfer(name, accNo) {
    document.getElementById('beneficiary_name').value = name;
    document.getElementById('account_number').value = accNo;
  }
</script>
{% endblock %}
